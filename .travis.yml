language: ruby
cache: bundler
sudo: false
rvm:
  - 2.2.5
services:
  - mysql
before_script:
  - bundle exec rake db:create RAILS_ENV=test
  - bundle exec rake db:schema:load RAILS_ENV=test
  - bundle exec rake snorby:start_worker RAILS_ENV=test
script:
  - bundle exec rake test

addons:
  apt:
    packages:
      - openssl
      - build-essential
      - xorg
      - libssl-dev
      - xfonts-75dpi
      - wkhtmltopdf
  code_climate:
    repo_token: 53ef942e93cf81c89c9488f305702e9e50ac30756898781c379dae9b73c42d24
after_success:
  - bundle exec codeclimate-test-reporter
